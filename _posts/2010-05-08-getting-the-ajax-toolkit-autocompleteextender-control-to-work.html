---
layout: post
title: Getting the AJAX toolkit, AutoCompleteExtender control to work
date: 2010-05-08 10:43:00.000000000 +08:00
type: post
published: true
status: publish
categories:
- ASP.NET
tags: []
meta:
  blogger_blog: tdtechdiary.blogspot.com
  blogger_author: Taher Dhilawala
  blogger_d55bd4009d1dee1a46eef7a078bee8f9_permalink: '7474475438685827719'
  _edit_last: '14307922'
  _wpas_skip_fb: '1'
author:
  login: tdtechdiary
  email: salaam_taher@yahoo.com
  display_name: Taher Dhilawala
  first_name: ''
  last_name: ''
---
<p>Recently I was working on the AJAX toolkit, AutoCompleteExtender control. While doing so I faced a lot of problem, to get it work. The control works only if all the things are in right places. I searched many forums (including MSDN) and got to know few things about getting that control work :). So I thought to write it down everything on one place so it might help someone else. I will explain how to use the control step by step.</p>
<ol style="margin-top:0;" type="1" start="1">
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">Download the latest AJAX control Toolkit from <a href="http://ajaxcontroltoolkit.codeplex.com/">here</a>.</li>
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">Add toolkit to your toolbox.</li>
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">Add a reference of <strong>Web.Extensions</strong> and <strong>Web.Extensions.Design </strong>in your project</li>
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">Drag and drop the AutoCompleteExtender control on your page</li>
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">Drag and drop the ScriptManager control on your page</li>
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">Set the required properties of the AutoCompleteExtender control. You can see the list of properties <a href="http://www.asp.net/ajax/ajaxcontroltoolkit/samples/autocomplete/autocomplete.aspx">here</a></li>
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">Two important properties are,</li>
<ul style="margin-top:0;" type="disc">
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">ServicePath: The path of webservice which you are using to get the data for the AutoCompleteExtender</li>
<li class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">ServiceMethod: The method in the webservice (<em>or page</em>) which will service your request.</li>
</ul>
</ol>
<div class="MsoNormal" style="text-align:justify;margin:0 0 .0001pt .5in;">There are two methods for working with AutoCompleteExtender,</div>
<div class="MsoListParagraphCxSpFirst" style="text-align:justify;text-indent:-.25in;margin:0 0 .0001pt 1in;"><span style="font-family:Symbol;">·</span>Webservice: You create a webservice that will be used to get the data</div>
<div class="MsoListParagraphCxSpLast" style="text-align:justify;text-indent:-.25in;margin:0 0 .0001pt 1in;"><span style="font-family:Symbol;">·</span>PageMethod: A method in the same page as that of control which will be used to get data.</div>
<div class="MsoNormal" style="text-align:justify;margin:0 0 .0001pt .5in;">I will explain what all needs to be done for using either of the methods.</div>
<div class="MsoNormal" style="margin-bottom:.0001pt;text-align:justify;">All the above mentioned things need to be done in .aspx page. Now let us look what all needs to be done in the code behind (example in c#).</div>
<div class="MsoListParagraphCxSpFirst" style="margin-bottom:.0001pt;text-align:justify;text-indent:-.25in;">1.Using a WebService,</div>
<div class="MsoListParagraphCxSpMiddle" style="text-align:justify;text-indent:-.25in;margin:0 0 .0001pt 1in;"><span style="font-family:Symbol;">·</span>Add a reference to <strong>System.Web.Script.Services</strong></div>
<div class="MsoListParagraphCxSpLast" style="text-align:justify;text-indent:-.25in;margin:0 0 .0001pt 1in;"><span style="font-family:Symbol;">·</span>Add the following above your web method,</div>
<div class="MsoNormal" style="line-height:normal;margin-bottom:.0001pt;"><span style="font-family:&quot;font-size:10pt;"> [System.Web.Services.WebMethod]</span></div>
<div class="MsoNormal" style="line-height:normal;margin-bottom:.0001pt;"><span style="font-family:&quot;font-size:10pt;"> [System.Web.Script.Services.ScriptMethod]</span></div>
<div class="MsoNormal" style="line-height:normal;margin:0 0 .0001pt 1in;">System.Web.Script.Services.ScriptMethod is required to inform ASP.net that we will be calling the webservice from withing JavaScript</div>
<div class="MsoNormal" style="line-height:normal;margin:0 0 .0001pt 1in;"><span style="color:red;">Note:</span> Be careful while naming your parameters inside your webmethod. They should be named as follow,</div>
<pre style="text-indent:1in;">string prefixText, int count</pre>
<pre style="text-indent:1in;"></pre>
<pre style="margin-left:1in;"><span style="font-family:&quot;font-size:11pt;">If you specify a different name, your code will not work. That is why I say the AutoCompleteExtender is very very strict</span></pre>
<div class="MsoNormal" style="line-height:normal;margin:0 0 .0001pt 1in;">Write your code inside your function and return a string[] from it.</div>
<div class="MsoListParagraphCxSpFirst" style="line-height:normal;margin-bottom:.0001pt;text-indent:-.25in;">2.Using a PageMethod,</div>
<div class="MsoListParagraphCxSpLast" style="line-height:normal;text-indent:-.25in;margin:0 0 .0001pt 1in;"><span style="font-family:Symbol;">·</span>Using a page method is similar to using a webservice. The only difference is that, you write your function in a .aspx page, as a normal function. But you need to specify the attribute [WebMethod] on your page function. Do not forget to add the things which are mentioned in the 1<sup>st</sup> point.</div>
<div class="MsoNormal" style="line-height:normal;margin-bottom:.0001pt;">Web.Config changes required,</div>
<div class="MsoNormal" style="line-height:normal;margin-bottom:.0001pt;">Add everything mentioned in the file in your web.config. This is really very important, if you miss even a single thing your AutoCompleteExtender won’t work,</div>
<pre> 
Download the web.config file <a href="http://rapidshare.com/files/392873390/web.config.txt">here</a>

<span style="font-family:&quot;font-size:11pt;">If you follow the above simple steps, I am sure you will get your AutoCompleteExtender to work the very first time</span><span style="font-family:&quot;font-size:11pt;">. Please comment if i have missed something or if you find this post interesting or helpful</span></pre>
<div class="blogger-post-footer"></div>
